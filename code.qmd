---
title: "code"
format: html
editor: visual
---

# Chargement des librairies

```{r}
#juliette
library(readr)
library(tsoutliers)
library(forecast)
library(rAmCharts)

#isaline
library(tseries)      
library(moments)
library(fBasics)
library(tibble)
library(ggplot2)
```

# Import des donn√©es

```{r}
y <- read_csv("data.csv")
```

# Cr√©ation de la ts

```{r}
yy <- ts(y$APU000072610, start=c(2000,01),frequency=12)
```

# 1) Analyse exploratoire

## a) Pr√©sentation et caract√©risation de la s√©rie √©tudi√©e : source, d√©finition, graphique

```{r}
plot.ts(yy, main = "Prix de l'√©lectricit√© moyen (par kW/h) des villes aux Etats_Unis (2000-2020)", ylab = "Prix", xlab = "Ann√©e")
```

## b) D√©tection des points atypiques. Pr√©senter ces points sous forme de tableau (date, type de point (AO, TC ...), t-stat) et trouver des explications √©conomiques de l'apparition des 3 plus importants

```{r}
# Automoatic procedure for detection of outliers
fit <- tso(yy)
plot(fit)
show(fit)
```

2 points atypiques d√©tect√©s :
Outliers:
  type ind    time   coefhat  tstat
1   LS  73 2006:01  0.004563  5.229
2   AO 172 2014:04 -0.004166 -6.790

Explication √©conomique :

1. Level Shift (LS) en janvier 2006 (2006:01) ‚Äì Coef : +0.004563
Ce que √ßa signifie : √Ä partir de janvier 2006, il y a eu une hausse durable du niveau des prix de l‚Äô√©lectricit√© dans les villes am√©ricaines. Ce n‚Äôest pas juste une fluctuation, mais un changement de r√©gime, une "cassure de tendance".

Hypoth√®ses √©conomiques possibles :

üìà Hausse du co√ªt des combustibles fossiles utilis√©s dans la production d‚Äô√©lectricit√© (charbon, gaz naturel).

‚öôÔ∏è R√©formes dans le march√© de l‚Äô√©lectricit√© : par exemple, d√©r√©glementation dans certains √âtats qui a conduit √† des hausses de prix.

üå± D√©but de politiques √©nerg√©tiques en faveur des √©nergies renouvelables, augmentant les co√ªts de transition pour les fournisseurs.

üîå Investissements dans les infrastructures √©lectriques (grilles intelligentes, s√©curit√©, maintenance‚Ä¶) r√©percut√©s sur les consommateurs.

üîé √Ä noter : entre 2005 et 2006, les prix du gaz naturel ont fortement augment√© aux √âtats-Unis (surtout apr√®s les ouragans Katrina et Rita en 2005), ce qui a probablement entra√Æn√© une hausse durable des prix de l‚Äô√©lectricit√©.

üìå 2. Additive Outlier (AO) en octobre 2014 (2014:04) ‚Äì Coef : -0.004166
Ce que √ßa signifie : En octobre 2014, il y a eu une baisse ponctuelle du prix moyen de l‚Äô√©lectricit√©. La s√©rie reprend son cours normal ensuite, donc ce n‚Äôest pas un changement structurel.

Hypoth√®ses √©conomiques possibles :

üõ¢Ô∏è Chute brutale des prix du p√©trole en 2014, qui a aussi impact√© les prix du gaz naturel (souvent utilis√© pour produire de l‚Äô√©lectricit√©). Cela a pu provoquer une baisse temporaire des prix de l‚Äô√©lectricit√©.

üåÄ Conditions climatiques exceptionnelles qui auraient r√©duit la consommation ou permis une production plus efficace.

üßæ Subventions temporaires ou politiques locales limitant les tarifs pendant une courte p√©riode.

üìâ Le prix du p√©trole a commenc√© √† chuter fortement √† la mi-2014, ce qui a eu des r√©percussions sur de nombreuses formes d‚Äô√©nergie.



```{r}
# outlier adjusted series
adj <- fit$yadj
plot(adj)
write(t(adj), file="adjusted-series.out", ncolumn = 1, append = FALSE)

tso(adj)
```
Il n'y a plus de points atypiques. 

## c) Statistiques descriptives sur la s√©rie corrig√©e (moyenne, √©cart-type, skewness, kurtosis normalit√©, box-plot ...). Commenter

### Statistiques descriptives

```{r}
stat = basicStats(y$APU000072610)
show(stat)
```

Pour commencer, nous observons que la moyenne et la m√©diane sont relativement proches, ce qui montre une bonne distribution des valeurs. N√©anmoins, la m√©diane est l√©g√®rement sup√©rieure √† la moyenne, ce qui laisse penser qu'il y a tout de m√™me une certaine asym√©trie.  De plus, l'√©cart type √©tant faible, cela indique que les valeurs sont faiblement dispers√©es autour de la moyenne et que les prix sont plut√¥t stable.

Ensuite, la Skewness √©tant n√©gative, de -0.5538, cela confirme la pr√©sence d'une l√©g√®re asym√©trie √† gauche. Alors, la plupart des valeurs sont √©lev√©es, cependant quelques valeurs faibles tirent la moyenne vers le bas.

En ce qui concerne le Kurtosis, nous trouvons un chiffre largement inf√©rieur √† 3 : la distribution est platycurtique. Ainsi, il y a peu de pics de valeurs extr√™mes sur cette p√©riode.

### Box-plot

```{r}
df <- tibble(value = as.numeric(yy))
ggplot(
  df, aes(y = value)) +
  geom_boxplot(fill = "royalblue", alpha = 0.5) +
  labs(title = "Boxplot de la s√©rie corrig√©e", y = "Valeur") +
  theme_minimal()
```

La s√©rie ne montre pas de potentielles valeurs atypiques.

## d) D√©tection de la saisonnalit√© et sch√©ma de d√©composition (additif ou multiplicatif)

```{r}

```

# 2) D√©saisonnalisation et d√©composition

## D√©saisonnaliser et d√©composer la s√©rie corrig√©e √† partir des m√©thodes X13-ARIMA SEATS. Commenter (effets d√©terministes, param√®tres ARIMA ...)

```{r}
myspec <- x13_spec("RSA5c")
mysax13 <- x13(adj, myspec)
summary(mysax13$regarima)
mysax13
plot(mysax13$final)

y_lin(mysats)


data('dat_stock_2')
```

# 3) Pr√©vision de la s√©rie saisonni√®re corrig√©e des points atypiques sur une ann√©e

## a) Estimer et pr√©voir les mod√®les suivants :

### (i) les m√©thodes Na√Øve, X13-ARIMA-SEATS, STL et STS. Commenter les mod√®les STS (variance : level, slope, seas, epsilon)

```{r}

```

### (ii) les m√©thodes de lissage exponentiel : Holt-Winters, ETS, TBATS, ADAM ETS, ADAM ETS SARIMA et SSARIMA. Commenter ces mod√®les.

```{r}

```

### (iii) un mod√®le SARIMA(p,d,q)(P,D,Q)12 . Commenter ce mod√®le.

```{r}

```

## b) Param√®tres : pr√©senter sous forme de tableau les param√®tres des mod√®les pr√©c√©dents. D√©terminer et commenter le meilleur mod√®le d'apr√®s les crit√®res AIC et AICc

```{r}

```

# 4) Repr√©senter graphiquement l'√©volution des pr√©visions des diff√©rents mod√®les et commenter.

```{r}

```

# 5) Qualit√© de pr√©vision : calculer les MSE et R2OOS de tous les mod√®les pr√©c√©dents (3a) et d√©finir le meilleur mod√®le. Comparer les √† celles d'une pr√©vision na√Øve. Faire √©galement le graphique des CSPE.

```{r}

```

# 6) Test de pr√©cision : calculer le test de Diebold-Mariano pour chaque mod√®le par rapport √†

la pr√©vision na√Øve et d√©finir le meilleur mod√®le (option ¬´ less ¬ª)

```{r}

```

# 7) Pr√©vision sur une ann√©e avec un pas de 1 mois avec le meilleur mod√®le de la question 6)

```{r}

```
